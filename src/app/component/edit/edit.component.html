<nz-layout style="height: 100%;overflow-y: hidden">
  <nz-header>
    <div class="logo">
      <i nz-icon type="book" theme="fill"></i>
      {{isCollapsed ? '' : 'Mdbook'}}
    </div>
  </nz-header>
  <nz-layout>
    <nz-sider nzCollapsible [(nzCollapsed)]="isCollapsed" [nzTrigger]="triggerTemplate"
              style="overflow-y: auto;background-color: white">
      <ul class="documents" nz-menu nzMode="inline" nzInlineIndent="12">
        <li nz-submenu>
          <span title (contextmenu)="contextMenu($event, rootTemplate, null)" style="display: block">文档</span>
          <ul>
            <li nz-submenu *ngFor="let node of getFolders(nodeMap)">
        <span title (contextmenu)="contextMenu($event, folderTemplate, node)" style="display: block">
          <i nz-icon type="folder"></i>{{node.name}}
        </span>
              <ul>
                <li nz-menu-item *ngFor="let child of getFilesByParent(node)"
                    (click)="selectFile(child)">
                <span title (contextmenu)="contextMenu($event, fileTemplate, child)" style="display: block">
                  <i nz-icon type="file-markdown"></i>{{child.name}}
                </span>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </nz-sider>
    <nz-layout style="height: 100%;overflow-y: hidden;background-color: white">
      <!--<div>-->
      <!--<i class="trigger" nz-icon [type]="isCollapsed?'menu-unfold':'menu-fold'"-->
      <!--(click)="isCollapsed=!isCollapsed"></i>-->
      <!--<i class="save" *ngIf="selectedFile" nz-icon type="save" style="float: right"-->
      <!--(click)="save(selectedFile)"></i>-->
      <!--</div>-->
      <nz-content>
        <div id="edit" style="height: 100%;"></div>
      </nz-content>
    </nz-layout>
  </nz-layout>
</nz-layout>


<ng-template #trigger>
  <i nz-icon type="up"></i>
</ng-template>

<ng-template #rootTemplate>
  <ul class="context-menu" nz-menu nzInDropDown>
    <li nz-menu-item (click)="close('create_folder')">创建文件夹</li>
  </ul>
</ng-template>
<ng-template #folderTemplate>
  <ul class="context-menu" nz-menu nzInDropDown>
    <li nz-menu-item (click)="close('create_file')">创建文件</li>
  </ul>
</ng-template>
<ng-template #fileTemplate>
  <ul class="context-menu" nz-menu nzInDropDown>
    <li nz-menu-item (click)="close('delete_file')">删除</li>
    <li nz-menu-item (click)="close('download_markdown')">下载markdown</li>
    <li nz-menu-item (click)="close('download_html')">下载html</li>
  </ul>
</ng-template>

<nz-modal [(nzVisible)]="isFileModalVisible" nzTitle="创建文件"
          (nzOnCancel)="isFileModalVisible=false"
          (nzOnOk)="createFile(fileInput.value)">
  <input #fileInput type="text" placeholder="文件名" style="border: none;outline: none;color: black">
</nz-modal>
<nz-modal [(nzVisible)]="isFolderModalVisible" nzTitle="创建文件"
          (nzOnCancel)="isFolderModalVisible=false"
          (nzOnOk)="createFolder(folderInput.value)">
  <input #folderInput type="text" placeholder="文件夹" style="border: none;outline: none;color: black">
</nz-modal>
